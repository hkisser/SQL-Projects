SELECT Department,
Employee,
salary
FROM
(
SELECT d.name as Department,
e.name as Employee,
salary,
DENSE_RANK() OVER(PARTITION BY d.name ORDER BY salary DESC) AS rank_
FROM
Employee e
LEFT JOIN Department d
ON e.departmentId = d.id
) a
WHERE rank_ = 1
